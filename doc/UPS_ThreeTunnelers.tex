\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{color}
\usepackage{array}
\usepackage{csquotes}

%Pravidlo pro řádkování
\renewcommand{\baselinestretch}{1.5}

%Pravidlo pro začínání kapitol na novém řádku
\let\oldsection\section
\renewcommand\section{\clearpage\oldsection}

%Formáty písem pro nadpisy (-změněno na bezpatkové \sffamily z původního \normalfont
\titleformat{\section}
{\sffamily\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
{\sffamily\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\sffamily\normalsize\bfseries}{\thesubsubsection}{1em}{}

%Nastavení zvýrazňování kódu v \lslisting
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\lstset{commentstyle=\color{mygreen},keywordstyle=\color{blue},numberstyle=\tiny\color{mygray}}

\author{Jan Šmejkal}

\begin{document}

%-------------Úvodni strana---------------
\begin{titlepage}

\includegraphics[width=50mm]{img/FAV.jpg}
\\[160 pt]
\centerline{ \Huge \sc KIV/UPS - Úvod do Počítačových sítí}
\centerline{ \LARGE \sc Semestrální práce }
\\[12 pt]
{\Huge \sc
\centerline{Three Tunnelers}
}


{
\vfill 
\parindent=0cm
\textbf{Jméno:} Štěpán Ševčík\\
\textbf{Osobní číslo:} A13B0443P\\
\textbf{E-mail:} kiwi@students.zcu.cz\\
\textbf{Datum:} {\large \today\par} %datum

}

\end{titlepage}

%------------------------------------------

%------------------Obsah-------------------
\newpage
\setcounter{page}{2}
\setcounter{tocdepth}{3}
\tableofcontents
%------------------------------------------

%--------------Text dokumentu--------------


\section{Zadání}
\noindent
Počítačová hra Three Tunnelers založená na původní DOSové hře Tunnelers sestávající z:
\begin{itemize}
\setlength\itemsep{-1em}
\item Herní klient implementovaný v jazyce JAVA
\item Herní server implementovaný v jazyce C
\end{itemize}
\subsection*{Zásady vypracování semestrální práce viz. CW}
\begin{itemize}
\setlength\itemsep{0em}
\item Úlohu naprogramujte v programovacím jazyku C/C++ anebo Java. Pokud se jedná o úlohu server/klient, pak klient bude v Javě a server v C/C++.

\item Komunikace bude realizována textovým nešifrovaným protokolem nad TCP protokolem.

\item Výstupy serveru budou v alfanumerické podobě, klient může komunikovat i v grafice (není podmínkou).

\item Server řešte pod operačním systémem Linux, klient může běžet pod OS Windows XP. Emulátory typu Cygwin nebudou podporovány.

\item Realizujte konkurentní (paralelní) servery. Server musí být schopen obsluhovat požadavky více klientů souběžně.

\item Součástí programu bude trasování komunikace, dovolující zachytit proces komunikace na úrovni aplikačního protokolu a zápis trasování do souboru.

\item Každý program bude doplněn o zpracování statistických údajů (přenesený počet bytů, přenesený počet zpráv, počet navázaných spojení, počet přenosů zrušených pro chybu, doba běhu apod.).

\item Zdrojové kódy organizujte tak, aby od sebe byly odděleny části volání komunikačních funkcí, které jste vytvořili na základě zadání, od částí určených k demonstraci funkčnosti vašeho řešení (grafické rozhraní).
\end{itemize}

\section{Úvod}
Three Tunnelers je síťová adaptace rozšiřující možnosti originální hry Tunnelers pro DOS. V této hře hráč přebírá kontrolu nad hrabacím tankem v podzemní oblasti a jeho cílem je zabrat tuto oblast pro sebe. V oblasti se nachází další hráči, jejichž cílem je to samé. Zabrání oblasti je možné docílit tím, že bude hráč poslední žijící nejvíce-krát z daného počtu kol.

Hlavní vlastností hry Tunnelers je, že si hráči musejí postupně získat přehled o oblasti z pohledů na půdorys. K dispozici totiž nemají pohled na celou oblast ale jen na malé části kolem tanků. Každý hráč vidí půdorysy nad všemi tanky.


\section{Programátorská dokumentace}
\subsection{Datové struktury}
Pro zjednodušení popisu funkcí systémů jsou předpokládány následující struktury:
\subsubsection*{Mapa}
Mapa představuje oblast, o kterou se bojuje. Oblast se skládá z (W * H) sekcí, takzvaných chunků, stejné velikosti N. V oblasti je několik sekcí, které představují základnu.
\subsubsection*{Chunk}
Chunk je malý útvar skládající se z bloků, který reprezentuje terén oblasti. Některé chunky obsahují seskupení bloků představující hráčskou základnu, u těchto chunků je nastaven identifikátor odpovídajícího hráče.
\subsubsection*{Tank}
Tank, rozlehlý 7*7 bloků, je struktura definující hráčem ovládaný prvek v oblasti. Tank je definován hráčem, kterému přísluší, svojí polohou na mapě a směrem, kam je natočen. Dále stav tanku definují jeho aktuální počet bodů zásahů, které zbývají do jeho zničení, zbývající energií a časem zbývajícím do možností vystřelení dalšího projektilu.



\subsection{Protokol}
Zprávy mezi klientem a serverem se přenáší pomocí protokolu realizovaného nad transportním protokolem TCP. Zprávy nemusí mít jednotnou délku ale vždy musí odpovídat následujícímu formátu:
\begin{center}
\texttt{<hlavička><tělo><LF>}
\end{center}
\begin{itemize}
\setlength\itemsep{0em}
\item \textbf{hlavička} zprávy se skládá ze 2 hexadecimálních znaků, které představují typ zprávy
\item \textbf{tělo} zprávy se odvíjí podle typu zprávy, čísla jsou přenášena v hexadecimální podobě a jsou vycpávána nulami na začátku do konstantní délky
\item \textbf{LF} představuje znak "Line Feed" a je vyžadován na konci každé zprávy
\end{itemize}

Protokol je bezestavový, což znamená, že žádná ze zpráv nevyžaduje okamžitou odpověď. Většina druhů zpráv však významově předpokládá návaznost jiných zpráv.

\subsubsection{Výčet typů zpráv a jejich významů}
\begin{table}[h]
\center
\begin{tabular}{|l|p{3cm}|l|p{10cm}|}
\hline
\textbf{Kód} & \textbf{Název} & \textbf{Zdroj} & \textbf{Tělo zprávy / poznámka}\\ \hline
0 & Nedefinováno & - & Používá se pro rozpoznání neplatného přenosu \\ \hline
1 & Potvrzení & K/S & Generické schválení požadavku, nepoužívat \\ \hline
2 & Zamítnutí & K/S & Generické zamítnutí požadavku, nepoužívat \\ \hline
3 & Echo Request & K/S & Vyžádání aktivity protější strany \\ \hline
4 & Echo Reply & K/S & Odpověď generující aktivitu \\ \hline
5 & Špatný formát & K/S & (zpráva) Oznámení protistraně o nerozpoznaném příkazu s neplatnou zprávou\\ \hline
6 & Představení & K/S & Představení klienta \newline Tělo zprávy od klienta nenese žádný význam \newline Tělo zprávy od serveru obsahuje klientské id tohoto klienta a tajný kód pro opětovné připojení \\ \hline
7 & Znovu-představení & K & Pokus o znovu navázání spojení pod stejnou identitou \\ \hline

\end{tabular}
\end{table}

\begin{table}[h]
\center
\begin{tabular}{|l|p{3cm}|l|p{10cm}|}
\hline
\textbf{Kód} & \textbf{Název} & \textbf{Zdroj} & \textbf{Tělo zprávy / poznámka}\\ \hline
10 & Vypsat místnosti & K & - \\ \hline
11 & Vytvořit místnost & K & - \\ \hline
12 & Vstoupit do místnosti & K & (XX) - číslo místnosti \\ \hline
20 & Opustit místnost & K & - \\ \hline
25 & Seznam místnosti & S & (XX)(XX)(M)*n - počet místností ve zprávě, zbývající počet místností výpisu, n identifikátorů místnosti \\ \hline
40 & Zpráva - prostý texůt & K/S & K: (zpráva) \newline S: (XX)(zpráva) - identifikátor odesílatele, 0 vždy odpovídá systému, v místnosti jsou pozice klientů číslovány od 1 \\ \hline
45 & Zpráva - příkaz & K & (zpráva) / umožňuje vzdálené vykonávání příkazů pro ovládání serveru jako z příkazové řádky \\ \hline
100 & Synchronizace fáze & S & (XX) aktuální fáze místnosti \\ \hline
101 & Kontrolní signál místnosti & K/S & (XX) identifikátor signálu - signály místnosti mají různé významy dle aktuální fáze\\ \hline
110 & Žádost o informace klienta & K & (XX) identifikátor klienta v místnosti \\ \hline
111 & Představení klienta & S & (XX)(XX)(jméno) - číslo klienta v místnosti, délka jména, jméno \\ \hline
112 & Odebrání klienta & S & (XX) - číslo klienta v místnosti \\ \hline

\end{tabular}
\end{table}

\begin{table}[h]
\center
\begin{tabular}{|l|p{3cm}|l|p{10cm}|}
\hline
\textbf{Kód} & \textbf{Název} & \textbf{Zdroj} & \textbf{Tělo zprávy / poznámka}\\ \hline
120 & Vyhodit klienta & K & (XX) číslo klienta v místnosti \\ \hline
121 & Předat vedení klientovi & K/S & (XX) číslo klienta v místnosti \\ \hline
130 & Přidání hráče & K/S & K: (XX) - slot v místnosti \newline S: (XX)(XX)(XX)(XX) - slot v místnosti, klient, hráč klienta, barva \\ \hline
131 & Odebrání hráče & K/S & (XX) - slot v místnosti \\ \hline
132 & Přesunutí hráće mezi sloty & K/S& (XX)(XX) - slot ODKUD, slot KAM \\ \hline
133 & Nastavení barvy hráče & K/S & (XX)(XX) - slot v místnosti, barva \\ \hline
140 & Specifikace mapy & S & (XX)(XX)(XX) - velikost chunku, šířka v chuncích, výška v chuncích \\ \hline
141 & Chunková data & S & (XX)(XX)(chunková data)\\ \hline
142 & Požadavek o chunk & K & (XX)(XX)(XX) - X chunku, Y chunku, checksum chunku \\ \hline
201 & Nastavení ovládání & K/S & (XX)(XX) - K: číslo hráče klienta, bitová mapa stisklých kláves \newline S: (XX)(XX) - číslo hráče v místnosti, bitová mapa stisklých kláves \\ \hline
210 & Požadavek o informace tanku & K & (XX) - číslo hráče v místnosti \\ \hline
211 & Informace o tanku & S & (XX)(XXXX)(XXXX)(XX)(XX)(XX)( - číslo hráče v místnosti, pozice X, pozice Y, směr, zdraví, energie tanku \\ \hline
220 & Vytvoření projektilu & S & (XX)(XX)(XX) - identifikátor projektilu, číslo hráče, počáteční směr \\ \hline
221 & Odstranění projektilu & S & (XX) - identifikátor projektilu \\ \hline


\end{tabular}
\end{table}


\subsection{Herní server}
Zdrojové soubory serveru jsou tříděny do modulů podle jejich významu...
\subsection{Herní klient}
Zdrojové soubory serveru jsou tříděny do balíků podle jejich významu...
\section{Uživatelská dokumentace}




%------------------------------------------

\end{document}
